#compdef build-llvm

_arguments -s \
  '--skip-update[Skip updating the LLVM repository]' \
  '--no-install[Build only, do not install]' \
  '--shallow[Perform a shallow clone and skip updates]' \
  '--all-arches[Build all LLVM targets instead of host only]' \
    '*--projects[Enable LLVM projects (semicolon-separated; default=clang)]:projects:_llvm_projects' \
    '--force-new[Remove the build directory and start the build from scratch]' \
    '--c-flags[Flags passed to CC]' \
    '--cxx-flags[Flags passed to CXX]' \
    '-cc[The C Compiler to use]' '-cxx[The C++ Compiler to use]'

_llvm_projects() {
  local -a projects
  projects=(
    bolt
    clang
    clang-tools-extra
    compiler-rt
    cross-project-tests
    libc
    libclc
    lld
    lldb
    mlir
    openmp
    polly
  )

  _values -C -s ';' 'LLVM projects' $projects
}
